<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="ja">
<head>
<script type="text/javascript" src="/js/bunner.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=shift_jis" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta name="description" content="借入可能額シミュレーション,キャッシングEXは今日中に借入れできる銀行系・消費者金融系キャッシングを比較、検索できるサイトです。" />
<meta name="keywords" content="借入可能額シミュレーション,キャッシングEX,即日融資,スピードキャッシング " />
<title>借入可能額シミュレーション | キャッシングEX</title>
<link rel="stylesheet" type="text/css" href="/css/style.css">
<link rel="shortcut icon" href="/images/favicon.ico">
<script type="text/javascript" src="/js/jquery.js"></script>
<script type="text/javascript" src="/js/common.js"></script>	
<!-- sego:top -->
<link href="simu.css" media="all" rel="stylesheet" type="text/css">
<script type="text/javascript" src="files/jquery-1.6.1.min.js" xml:space="preserve"></script>
<script type="text/javascript" src="files/jquery-jtemplates_uncompressed.js" xml:space="preserve"></script>
<script type="text/javascript" src="files/jquery.timer.js" xml:space="preserve"></script>
<script type="text/javascript" src="files/jSleep.js"></script>

<!-- sego:end -->

</head>

<body id="pagetop">

<!--#include virtual="/header.html" -->

<div id="container">
<div class="main_area">
<h2 class="tt">借入可能額シミュレーション</h2>
<div class="text_area">
<p>今月はあとどれくらい足りない？自分はどれぐらい借りられる？<br>
</p>
<p>そんなときは借入可能額シミュレーションを使って、現状で借りられる金額を把握しておくと、スムーズにキャッシング先を絞ることができます。ポイントはシミュレーション情報を忘れずに、希望する限度額を欲張らず、<br>
  希望する限度額内、利用日数、提出書類などの手続き方法からキャッシング先を選ぶことです。</p>
</div>
<p class="sst_simulation">各項目に入力してください　<span><font color="#FF0000">※</font>半角数字で入力してください。</span></p>


<div class="simulationArea">
<div id="loader" name="loader"></div>


<form id="cashing" method="post" class="simulation_area" onsubmit="javascript:return false;" name="cashing">
<!--fieldset-->
<table width="640" border="0" cellpadding="0" cellspacing="1" bgcolor="#dcdcdc">
<tr>
<th width="165">職業&nbsp;<span class="red">※</span></th>
<td>
<table width="0" border="0" cellspacing="0" cellpadding="0" class="inner_table_c">
<tr>
<td><label for="job-1"><input id="job-1" type="radio" class="radio" name="user_job" value="0" checked/>自営業・会社役員</label></td>
</tr>
<tr>
<td><label for="job-2"><input id="job-2" type="radio" class="radio" name="user_job" value="1" />会社員</label></td>
</tr>
<tr>
<td><label for="job-3"><input id="job-3" type="radio" class="radio" name="user_job" value="2" />派遣社員</label></td>
</tr>
<tr>
<td><label for="job-4"><input id="job-4" type="radio" class="radio" name="user_job" value="3" />主婦</label></td>
</tr>
<tr>
<td><label for="job-5"><input id="job-5" type="radio" class="radio" name="user_job" value="4" />学生</label></td>
</tr>
</table>
<!--select style="background-color:#FFF;" id="user_job" name="user_job" style="visibility:hidden;">
<option value="0">自営業・会社役員</option>
<option value="1">会社員</option>
<option value="2">派遣社員</option>
<option value="3">主婦</option>
<option value="4">学生</option>
</select-->

</td>
</tr>
<tr>
<th rowspan="2">昨年の年収&nbsp;<span class="red">※</span></th>
<td><table width="0" border="0" cellspacing="0" cellpadding="0" class="inner_table">
<tr>
<td width="100">本人の年収</td>
<td><input id="income1" name="income1" type="text" class="normal_txtfield" value="">万円</td>
</tr>
</table></td>
</tr>
<tr>
<td><table width="0" border="0" cellspacing="0" cellpadding="0" class="inner_table">
<tr>
<td width="100">配偶者の年収</td>
<td><input id="income2" name="income2" type="text" class="normal_txtfield" value="">万円</td>
</tr>
</table></td>
</tr>
<tr>
<th>利用目的&nbsp;<span class="red">※</span></th>
<td><table width="0" border="0" cellspacing="0" cellpadding="0" class="inner_table_c">
<tr>
<td width="160">
<label for="use-1"><input id="use-1" type="radio" class="radio" name="debt_obj" value="0" checked/>生活費</label></td>
<td><label for="use-2"><input id="use-2" type="radio" class="radio" name="debt_obj" value="1" />医療費</label></td>
</tr>
<tr>
<td><label for="use-3"><input id="use-3" type="radio" class="radio" name="debt_obj" value="2" />交際費</label></td>
<td><label for="use-4"><input id="use-4" type="radio" class="radio" name="debt_obj" value="3" />教育費</label></td>
</tr>
<tr>
<td><label for="use-5"><input id="use-5" type="radio" class="radio" name="debt_obj" value="4" />レジャー</label></td>
<td><label for="use-6"><input id="use-6" type="radio" class="radio" name="debt_obj" value="5" />おまとめ</label></td>
</tr>
<tr>
<td><label for="use-7"><input id="use-7" type="radio" class="radio" name="debt_obj" value="6" />冠婚葬祭</label></td>
<td><label for="use-8"><input id="use-8" type="radio" class="radio" name="debt_obj" value="7" />車関係</label></td>
</tr>
</table>

<!--select style="background-color:#FFF;" id="debt_obj" name="debt_obj">
<option value="0">生活費</option>
<option value="1">交際費</option>
<option value="2">レジャー資金</option>
<option value="3">冠婚葬祭</option>
<option value="4">医療費</option>
<option value="5">教育費</option>
<option value="6">おまとめ</option>
<option value="7">車関連費</option>
<option value="8">その他</option>
</select-->

</td>
</tr>
<tr>
<th rowspan="2">現在のキャッシング<br>
利用状況&nbsp;<span class="red">※</span></th>
<td><table width="0" border="0" cellspacing="0" cellpadding="0" class="inner_table">
<tr>
<td width="100">現在の借入額</td>
<td><input id="debt_now" name="debt_now" type="text" class="normal_txtfield" value="">
万円</td>
</tr>
</table></td>
</tr>
<tr>
<td><table width="0" border="0" cellspacing="0" cellpadding="0" class="inner_table">
<tr>
<td width="100">借入件数</td>
<td><select name="debt_cnt" id="debt_cnt" class="normal_select">
<option value="0" selected>0</option>
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4</option>
<option value="5">5</option>
<option value="6">6</option>
<option value="7">7</option>
<option value="8">8</option>
<option value="9">9</option>
<option value="10">10〜</option>
</select>件</td>
</tr>
</table></td>
</tr>
<tr>
<th>融資希望額&nbsp;<span class="red">※</span></th>
<td><table width="0" border="0" cellspacing="0" cellpadding="0" class="inner_table">
<tr>
<td><input type="text" id="debt_num" name="debt_num" class="normal_txtfield" value="">万円</td>
</tr>
</table></td>
</tr>
</table>


<!-- エラー -->
<div class="err-description" id="cashing-errors">

</div>


<div class="submit_button">
<div class="submit_sim">
	  <input id="cashingGo" name="cashingGo" value="" type="button" class="btn" />
    </div>
</div>
</form>


<!-- 結果 -->
<div class="sim_result">
<p class="sst_sim_result"><img src="/images/sst_sim_result.jpg" alt="シミュレーション結果" width="200" height="37"></p>
<p class="sim_result_price">0</p>
<div class="sim_result_txt"><img src="/images/sim_result_txt_02.png" alt=""該当するカードはありませんでした。条件を変えて再度検索してください。" width="405" height="102"></div>
<p class="sim_result_stxt">ご入力いただいた情報を元に集計した当サイトの結果には、実際のご融資と若干の誤差がある場合がございます。</p>
</div>

<div class="result">
<div class="value">
<!--span id="cashing-kingaku" class="sim_result_price">0</span-->
</div>
<!--div class="txt">必要な項目を入力すると借入シミュレーション金額を表示します。</div-->
</div>
<!-- /div.simulationArea --></div>
<div class="candidate">
<div class="col">


<!-- 結果が入ります -->
<div class="companyBox">

	<!--ul id="cashing-items">
	<li>&nbsp;</li>
	</ul>
	<ul id="cashing-olds">
	<li>&nbsp;</li>
	</ul-->
	
</div>

</div>
</div>

<!-- /div.main_area --></div>
<!--#include virtual="/sidemenu_result.html" -->
<div class="page_scroll"><a href="#pagetop"><img src="/images/pagescroll_off.gif" alt="ページの先頭へ" width="130" height="30" border="0"></a></div>
<!-- /div.container --></div>

<!--#include virtual="/footer.html" -->


<!--●●ココからjQueryフォーム●●-->


<script type="text/javascript" xml:space="preserve">

//$.ajaxSetup({scriptCharset:'utf-8'});

//グローバル変数
var input_check;
var user_job;
var income1;
var income2;
var debt_now;
var debt_cnt;
var debt_obj;
var debt_num;
var incomeTotal;
var income_debt;
var debt_rate_0,debt_rate_1,debt_rate_2,debt_rate_3;
var compair_num,enable_debt;
var debt_answer;
var debt_enable;
var debt_matome;
var csvFile1,csvFile2;
var csvArTb1,csvArTb2;
var csvArCt1 = 101;
var csvArCt2 = 8;
var readflg1 = true;
var readflg2 = true;
var htmlmsg1,htmlmsg2;
//関数
var Cashing = new Object({
	warnflag:false,
	init:function(){
		$('#cashingGo').click(function(){
			$('#loader').show(); // 読み込み中
			
			/* 実行部 */
			Cashing.warnflag = true; 
			Cashing.update(); 
			Cashing.showLoanRst();
			
			setTimeout(function() {
				$('#loader').hide(); // 読み込み中
			}, 1000);
		});
		
		$.timer (100, function (timer) {
			Cashing.update();
			timer.reset(1000);
		});
	},


    showLoanRst: function(){

	//借り入れ情報BOXの初期化
	$(".sim_result_price").html('0');
	$(".companyBox").empty();

	if (input_check) {
		//*debug02*
		//融資金額
		//■要確認sego■借金率は四捨五入したものを使用？
		enable_debt = 0;
		for (i = 0; i < csvArCt1; i++) {
			if (debt_rate_1 <= csvArTb1[i][0]) {
				enable_debt = csvArTb1[i][1];
				break;
			}
		}
		debt_answer = income_debt * enable_debt / 100;
		//■要確認sego■四捨五入の必要は？
		/*
		debt_answer = Math.round(debt_answer);
		debt_answer = Math.ceil(debt_answer);
		*/
		debt_answer = Math.floor(debt_answer);
		//融資可能先数
		debt_enable = 0;
		//おまとめflag
		debt_matome = 0;
		//借り入れ条件の精査
		if (debt_cnt >= 10 || debt_answer == 0) {
			// NG #11
			$(".sim_result_price").html('0');
//			$.get('sjis2utf8n.php?file=_ng.html', '', function(data) {
//				$(".sim_result_txt").append(data);		
//			});
			$(".sim_result_txt").html('<img src="/images/sim_result_txt_02.png">');

			
		} else {
			var csvloopC = csvArCt2 -1;
			var dispflag;
			var CSV = '';
			for (i = 1; i <= csvloopC; i++) {
				dispflag = true;
				// 借り入れ件数
				if (debt_cnt >= csvArTb2[i][1]) {
					dispflag = false;
				}
				
				// おまとめ
				// http://webhako.net/jquery/radio-get-value/ @2014-09-15
				if ((debt_rate_1 >= 59) || ($('#use-6:checked').val() == 5)) {
					//alert($("input[name='debt_obj']:checked").val());
					if (csvArTb2[i][17] == 2) {
						dispflag = false;	//借金率≧59の場合、おまとめflg==2ならNG
					} else {
						debt_matome = 1;	//借金率≧59でかつ、おまとめ融資OKの場合
					}
				}
				//借り入れ条件の判断
				if (dispflag) {
					// #12
					//JSleep(0.01);
					
					/* #10 
					$.get('sjis2utf8n.php?file=..' + csvArTb2[i][3], '', function(data) {
						$(".companyBox").append(data);
					});
					*/
					CSV = CSV + csvArTb2[i][3] + ';';
					//融資可能先数
					debt_enable++;
				}
			}
			
			
			
			// #12
			//alert(CSV);
			$.get('hogehoge.php?files=' + CSV, '', function(data) {
						$(".companyBox").append(data);
					});
			
			
			//融資診断結果
			if (debt_enable == 0 || debt_answer <= 0) {
				// NG #11
				$.get('sjis2utf8n.php?file=_ng.html', '', function(data) {
					$(".companyBox").append(data);
				});
//				$(".sim_result_txt").html('ご融資は難しいと思われます。');
//				$(".sim_result_txt").html('<img src="/images/sim_result_txt_02.png">');
				debt_answer = 0;
			} else {
				//alert(debt_matome);
				if (debt_matome == 0) {
//					$.get('sjis2utf8n.php?file=_yushi.html', '', function(data) {
//						$(".txt").html(data);
//					});
					$(".sim_result_txt").html('<img src="/images/sim_result_txt_01.png">');
				} else {
//					$.get('sjis2utf8n.php?file=_omatome.html', '', function(data) {
//						$(".txt").html(data);
//					});
					$(".sim_result_txt").html('<img src="/images/sim_result_txt_03.png">');
				}
			}
			$(".sim_result_price").html(debt_answer);
		}
//↓input_check判定用if文
	}
//↑input_check判定用if文
    },
	update: function() {
		var postFlag = true;
		var errors = [];
		var warnings = [];
		/* 職種
		user_job = $('#user_job').val();
		if (!user_job.length) {
			postFlag = false;
			$('#user_job').attr('style', 'background-color:#FFDFDF;');
			warnings.push("　ご職業を選択してください。");
		} else {
			$('#user_job').attr('style', 'background-color:#FFF;');
		}
		*/
		// 昨年の年収
		income1 = $('#income1').val();
		if (!income1.length) {
			postFlag = false;
			$('#income1').attr('style', 'background-color:#FFDFDF;');
			warnings.push("　昨年の年収が入力されていません。");
		} else if (income1.match(/[^0-9]/g)) {
			postFlag = false;
			$('#income1').attr('style', 'background-color:#FFDFDF;');
			errors.push("　昨年の年収は数字で入力してください。");
		} else {
			$('#income1').attr('style', 'background-color:#FFF;');
		}
		// 配偶者の年収
		income2 = $('#income2').val();
		if (!income2.length) {
			postFlag = false;
			$('#income2').attr('style', 'background-color:#FFDFDF;');
			warnings.push("　配偶者の年収が入力されていません。");
		} else if (income2.match(/[^0-9]/g)) {
			postFlag = false;
			$('#income2').attr('style', 'background-color:#FFDFDF;');
			errors.push("　配偶者の年収は数字で入力してください。");
		} else {
			$('#income2').attr('style', 'background-color:#FFF;');
		}
		// 現在の借入れ額
		debt_now = $('#debt_now').val();
		if (!debt_now.length) {
			postFlag = false;
			$('#debt_now').attr('style', 'background-color:#FFDFDF;');
			warnings.push("　現在の借入れ額が入力されていません。");
		} else if (debt_now.match(/[^0-9]/g)) {
			postFlag = false;
			$('#debt_now').attr('style', 'background-color:#FFDFDF;');
			errors.push("　現在の借入れ額は数字で入力してください。");
		} else {
			$('#debt_now').attr('style', 'background-color:#FFF;');
		}
		// 借り入れ件数
		debt_cnt = $('#debt_cnt').val();
		if (!debt_cnt.length) {
			postFlag = false;
			$('#debt_cnt').attr('style', 'background-color:#FFDFDF;');
			warnings.push("　借り入れ件数が選択されていません。");
		} else {
			$('#debt_cnt').attr('style', 'background-color:#FFF;');
		}
		/* 利用目的
		debt_obj = $('#debt_obj').val();
		if (!debt_obj.length) {
			postFlag = false;
			$('#debt_obj').attr('style', 'background-color:#FFDFDF;');
			warnings.push("　ご利用目的が入力されていません。");
		} else {
			$('#debt_obj').attr('style', 'background-color:#FFF;');
		}
		*/
		// 融資希望額
		debt_num = $('#debt_num').val();
		if (!debt_num.length) {
			postFlag = false;
			$('#debt_num').attr('style', 'background-color:#FFDFDF;');
			warnings.push("　借り入れ希望額が入力されていません。");
		/*
		} else if (debt_num.match(/[^0-9]/g)) {
			postFlag = false;
			$('#debt_num').attr('style', 'background-color:#FFDFDF;');
			errors.push("　借り入れ希望額は数字で入力してください。");
		*/
		} else {
			$('#debt_num').attr('style', 'background-color:#FFF;');
		}
		//■エラー表示消去・初期化■
		$("#cashing-errors").html('');
		//■入力エラーがあれば警告■
		if (errors.length || warnings.length) {
			if (this.warnflag && warnings.length) {
				errors = $.merge(warnings, errors);
			}
			if (errors.length) {
				$("#cashing-errors").html('<div class="errorBox">【以下の項目を正しく入力してください】</div>');
				$.each(errors, function(index , value){
					$(".errorBox").append('<br />').append(value);
				})
			}
		}
		input_check = postFlag;
		//報酬合計
		incomeTotal = eval($('#income1').val()) + eval($('#income2').val());
		//報酬-借金
		income_debt = eval(incomeTotal) - eval($('#debt_now').val());
		//借金率（四捨五入・切上・切捨）の計算
		if (income_debt <= 0) {
			//借金＞報酬の場合
			//■要確認sego■実際に使う値は四捨五入した値？
			income_debt = 0;
			debt_rate_0 = 100;
			debt_rate_1 = debt_rate_0;
			debt_rate_2 = debt_rate_0;
			debt_rate_3 = debt_rate_0;
		} else {
			debt_rate_0 = eval($('#debt_now').val()) / eval(incomeTotal) * 100;
			debt_rate_1 = Math.round(debt_rate_0);
			debt_rate_2 = Math.ceil(debt_rate_0);
			debt_rate_3 = Math.floor(debt_rate_0);
		}
		/*
		借金・可能率table[debtrate.csv]read■註■ローカル環境では[makecsvArTb1]通信NG
		※ボタンClick時にcsv読み込ますと1回目のボタン操作が無効になるのでココにて処理
		■要確認sego■借金=0および借金>58の場合は？
		*/
		if (readflg1) {
			csvFile1 = createXMLHttpRequest(makecsvArTb1);
			if (csvFile1) {
				csvFile1.open("GET","files/debtrate.csv",true);
				csvFile1.send(null);
			}
			readflg1 = false;
		}
		/*

		借金・可能率table[dbConfig.csv]read■註■ローカル環境では[makecsvArTb1]通信NG
		※ボタンClick時にcsv読み込ますと1回目のボタン操作が無効になるのでココにて処理
		*/
		if (readflg2) {
			csvFile2 = createXMLHttpRequest(makecsvArTb2);
			if (csvFile2) {
				csvFile2.open("GET","files/dbConfig.csv",true);
				csvFile2.send(null);
			}
			readflg2 = false;
		}

	}
});

$(document).ready(function() {
	Cashing.init();
	$('#loader').hide(); // 読み込み中	
	
});

function makecsvArTb1()
{
	if ((csvFile1.readyState == 4) && (csvFile1.status == 200)) {
		csvArTb1 = parseTabText(csvFile1.responseText, csvArTb1, csvArCt1);
	//■註■ローカル環境では[if]条件を満たさないまま、無限loopする
	}
}
function makecsvArTb2()
{
	if ((csvFile2.readyState == 4) && (csvFile2.status == 200)) {
		csvArTb2 = parseTabText(csvFile2.responseText, csvArTb2, csvArCt2);
	//■註■ローカル環境では[if]条件を満たさないまま、無限loopする
	}
}

/* CSVファイルを解析して表示 */
function parseTabText(tabText, csvTable, CsvLcnt)
{
	var ListCnt = CsvLcnt;
	csvTable = new Array(ListCnt);
	for (var i = 0; i < ListCnt; i++) {
		csvTable[i] = ['0', '0'];
	}
	lineData = tabText.split("\r\n");
	for (var i=0; i<lineData.length; i++)
	{
		wCount = lineData[i].split(",");
		for (j=0; j<wCount.length; j++)
		{
			tData = wCount[j];	//csv内部data
			if (tData != "") {
				csvTable[i][j] = (tData);
			}
		}
	}
	return csvTable;
}
/* ファイル展開 */
function createXMLHttpRequest(cbFunc)
{
	var XMLhttpObject = null;
	try{
		XMLhttpObject = new XMLHttpRequest();
	}catch(e){
		try{
			XMLhttpObject = new ActiveXObject("Msxml2.XMLHTTP");
		}catch(e){
			try{
				XMLhttpObject = new ActiveXObject("Microsoft.XMLHTTP");
			}catch(e){
				return null;
			}
		}
	}
	if (XMLhttpObject) XMLhttpObject.onreadystatechange = cbFunc;
	return XMLhttpObject;
}


</script>


<!--●sego:end●-->

</body>

</html>
